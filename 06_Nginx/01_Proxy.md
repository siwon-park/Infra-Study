# 01_Proxy

> Proxy 서버란 클라이언트를 다른 네트워크 서비스에 연결시켜주는 중계 프로그램이다.

`프록시(Proxy)`란 `대리자`, `대행자`의 의미를 가지고 있다.

프로그래밍에서 프록시, 프록시 패턴이라는 말을 자주 접할 수 있는데, 여기서 말하는 프록시도 역시 어떤 일을 대신 수행해주는 프로그램을 말한다.

대신 수행하는 일은 객체 생성 및 초기화, 유효성 검사, 로직 수행 등 다양하다.

Subject 인터페이스와 이를 구현한 Real Subject와 Proxy를 두고, Client가 Real Subject에 직접 접근해서 일을 처리하는 것이 아니라 Proxy를 통해서 Real Subject에 접근하여 로직을 대신 처리하게 하는 패턴이 프록시 패턴이다.

<br>

## 1. Nginx의 역할

Nginx는 프록시와 밀접한 관련이 있다.

### 1) 정적 리소스 제공

Nginx는 정적 리소스(static resource)를 제공(serve)하는 역할을 수행한다.

이미지나 CSS와 같은 정적인 리소스에 대한 요청이 들어왔을 때 이를 Nginx에 맡기고, 동적(dynamic)으로 계산이 필요하거나 전달해야 할 컨텐츠들에 대해서는 어플리케이션 서버가 처리한다.

<br>

### 2) 프록시 서버 역할

Nginx의 핵심 역할 중에는 프록시 서버(Proxy Server)가 있다.

프록시 서버란 `클라이언트와 서버 사이에서 요청과 응답을 중개해주는 역할을 하는 서버`를 말하며, 일반적으로 서버 기반으로 동작하기 때문에 프록시 서버라는 이름이 붙은 것이다.

![image](https://user-images.githubusercontent.com/93081720/227755837-b38c79b0-3af6-4892-9e5e-3b595fcba09d.png)

Nginx가 제공하는 Reverse Proxy 기능으로 클라이언트의 요청에 대해서 특정 서비스(서버)로 접근할 수 있도록 프록시 패스를 지정할 수 있다.

<br>

## 2. 프록시 서버(Proxy Server)

### 1) 프록시 서버 도입 목적

클라이언트의 요청을 서버가 직접 처리해도 되는데 왜 굳이 번거롭게 한 단계 더 거치도록 해놓았을까?

프록시 서버를 두면 한 단계 더 거쳐야할 곳이 생기는 것은 맞지만, 프록시 서버를 둠으로써 얻을 수 있는 강력한 이점들이 있기 때문이다.

#### (1) 보안

익명의 사용자가 함부로 직접적으로 웹 서버로 접근하지 못하게 막는다. 

또한 서버에 대한 사용자의 접근을 허용할 것인지 말 것인지에 대한 정책을 정의할 수 있어 정책적인 기능을 하기도 한다.(ACL)

즉, 프록시 서버를 거쳐서 접속하게 함으로써 보안적인 이점을 얻을 수 있다.

#### (2) 속도

프록시 서버에서 사용자의 요청을 캐싱(caching)하여 가지고 있다가, 동일한 요청이 오면 이를 어플리케이션 서버에 전달하는 것이 아니라 캐싱된 정보를 사용하여 불필요한 리소스 낭비를 막고 빠른 응답을 제공하여 속도면에서 이점을 제공한다.

#### (3) 로깅

서버로 접근하는 사용자에 대한 정보를 로깅, 수집할 수 있다.

#### (4) 우회

보안, 트래픽 등의 이유로 네트워크 접근에 제한이 있을 경우 다른 서비스로 우회할 수 있도록 하는 기능을 제공한다.

<br>

### 2) 프록시 서버의 종류

#### (1) 포워드 프록시 (Forward Proxy)

>  앞단에서 프록시 서버가 중계하는 형태

클라이언트가 특정 서비스에 대한 요청을 하면 요청한 타겟 서비스의 서버로 그대로 전달해 준다.

즉, `a-1`이라는 요청을 하면 `a-1`로 전달해 준다.

![image](https://user-images.githubusercontent.com/93081720/227756540-a3f2283d-1ec9-4876-9af0-89a764e4d021.png)

포워드 프록시는 앞단에 위치하는 만큼 주로 보안적인 목적을 위해서 두는 경우가 많다.

#### (2) 리버스 프록시 (Reverse Proxy)

>  뒷단에서 프록시 서버가 중계하는 형태

클라이언트가 특정 서비스에 대한 요청을 하면 요청한 타겟 서비스의 서버로 전달해주긴 하나, 같은 타겟 서버 내 다른 서비스를 처리하는 곳으로 보내질 수도 있다.

즉, `a-1`이라는 요청을 하더라도, `a-1`이라는 요청을 내부적으로 처리하여 `a-1`, `a-2`, `a-3` 등으로 보내질 수 있다.

![image](https://user-images.githubusercontent.com/93081720/227756550-cd35dd20-ae53-4707-b820-eb9e0e86e42a.png)

리버스 프록시는 포워드 프록시와 달리 분산, 분배 등과 같은 기능도 할 수 있기 때문에 보다 효율적으로 요청과 응답을 중개하기 위해 주로 사용된다.

<br>